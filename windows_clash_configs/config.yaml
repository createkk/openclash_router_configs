mixed-port: 7890
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
ipv6: false

profile:
    store-selected: true
    store-fake-ip: true
    
unified-delay: true
tcp-concurrent: false

# ui部分
external-controller: 0.0.0.0:9090 # 网页端口
secret: ""
external-ui: .\ui\public

# Tun 配置 Windows使用
tun:
    enable: false  #PC端按需开启 不建议小白开启 路由器不开启
    stack: mixed # gvisor / lwip
    dns-hijack:
        - 0.0.0.0:53 # 需要劫持的 DNS
    auto-route: true # 自动设置全局路由，可以自动将全局流量路由进入tun网卡。
    auto-detect-interface: true # 自动识别出口网卡
    endpoint-independent-nat: true
    inet4-route-address: # 启用 auto-route 时使用自定义路由而不是默认路由
        - 0.0.0.0/1
        - 128.0.0.0/1
#  inet6-route-address: # 启用 auto-route 时使用自定义路由而不是默认路由
#    - "::/1"
#    - "8000::/1"

dns:
    enable: true
    cache-algorithm: arc
    prefer-h3: false
    use-hosts: true
    use-system-hosts: true
    listen: 0.0.0.0:1053
    ipv6: false
    default-nameserver:
        - system
        - 223.5.5.5
    nameserver:
        - system
    enhanced-mode: fake-ip
    fake-ip-range: 198.18.0.1/16
    fake-ip-filter:
        - 'rule-set:private'
        - 'rule-set:direct'
        - '*.lan'
        - '*.local'
        - '*.arpa'
        - 'time.*.com'
        - 'ntp.*.com'
        - '+.market.xiaomi.com'
        - 'localhost.ptlogin2.qq.com'
        - '*.msftncsi.com'
        - 'www.msftconnecttest.com'
        # WiFi-Calling 如果你发现你的WiFi Calling不能发图片 大概率是节点UDP问题
        - t-mobile.com
        - crl.t-mobile.com
        - eas3.msg.t-mobile.com
        - mascns.t-mobile.com
        - ns.sipgeo.t-mobile.com
        - epdg.epc.mnc240.mcc310.pub.3gppnetwork.org
        - epdg.epc.mnc260.mcc310.pub.3gppnetwork.org
        - ss.epdg.epc.mnc260.mcc310.pub.3gppnetwork.org
        - ss.epdg.epc.geo.mnc260.mcc310.pub.3gppnetwork.org     
    fake-ip-filter-mode: blacklist


#自建节点存放地址
proxies:

#代理组
proxy-groups:    
#其他规则
    - name: Proxy
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Auto
      use:
          - subscribe_groups 
#自动选择          
    - name: Auto
      type: fallback # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
      use:
          - subscribe_groups 
      url: "http://www.apple.com/library/test/success.html"
      interval: 300   #自动测速周期，单位：秒  
# 苹果      
    - name: Apple
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - DIRECT
      use:
          - subscribe_groups  
# BiliBili      
    - name: Bilibili
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - DIRECT
      use:
          - subscribe_groups  
# 奈飞      
    - name: Netflix
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups  
# 迪士尼      
    - name: Disney
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups 
# Tiktok      
    - name: TikTok
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups        
# 全局媒体      
    - name: GlobalMedia
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups  
# OpenAi      
    - name: OpenAI
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups  
# 谷歌      
    - name: Google
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups  
# 微软
    - name: Microsoft
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups    
# SteamCN
    - name: SteamCN
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - DIRECT
      use:
          - subscribe_groups   
           
# Steam
    - name: Steam
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - DIRECT
      use:
          - subscribe_groups   
          
# Paypal
    - name: Paypal
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - DIRECT
      use:
          - subscribe_groups   

# Telegram
    - name: Telegram
      type: select # 下面开启了自动测速
      proxies:
#         - test 这里填写你的自建节点
          - Proxy
      use:
          - subscribe_groups   
                              
#代理集  如果是自建节点屏蔽这里  
proxy-providers:
    #自定义机场名称subscribe_groups
    subscribe_groups:
        type: http # http 的 path 可空置,默认储存路径为 homedir的proxies文件夹,文件名为url的md5
        url: "" #机场的订阅链接存放在双引号内
        interval: 86400 #机场订阅自动更新时间 单位：秒
        path: ./hj_sub.yaml # 默认只允许存储在 clash 的 Home Dir，如果想存储到任意位置，添加环境变量 SKIP_SAFE_PATH_CHECK=1
        health-check:
            enable: true
            interval: 300
            url: http://cp.cloudflare.com/generate_204
      
rule-providers:
    Apple:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple_Classical_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Apple_No_Resolve.yaml
    BiliBili:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/BiliBili/BiliBili_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/BiliBili_No_Resolve.yaml
    Netflix:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Netflix_No_Resolve.yaml
    Disney:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Disney_No_Resolve.yaml
    TikTok:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/TikTok_No_Resolve.yaml
    GlobalMedia:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia_Classical_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/GlobalMedia_Classical_No_Resolve.yaml
    OpenAI:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/OpenAI_No_Resolve.yaml
    Google:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Google_No_Resolve.yaml
    Microsoft:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Microsoft_No_Resolve.yaml
    PayPal:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/PayPal/PayPal_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/PayPal_No_Resolve.yaml
    Telegram:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Telegram_No_Resolve.yaml
    SteamCN:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/SteamCN/SteamCN_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/SteamCN_No_Resolve.yaml
    Steam:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Steam/Steam_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Steam_No_Resolve.yaml
    Lan:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/Lan_No_Resolve.yaml
    ChinaMax:
        type: http
        behavior: classical
        url: "https://raw.gitmirror.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMax/ChinaMax_Classical_No_Resolve.yaml"
        interval: 86400
        path: ./ruleset/ChinaMax_Classical_No_Resolve.yaml
rules:
    - RULE-SET,Apple,Apple
    - RULE-SET,BiliBili,BiliBili
    - RULE-SET,Netflix,Netflix
    - RULE-SET,Disney,Disney
    - RULE-SET,TikTok,TikTok
    - RULE-SET,OpenAI,OpenAI
    - RULE-SET,SteamCN,SteamCN
    - RULE-SET,Steam,Steam
    - RULE-SET,Google,Google
    - RULE-SET,PayPal,PayPal
    - RULE-SET,Telegram,Telegram
    - RULE-SET,Microsoft,Microsoft
    - RULE-SET,GlobalMedia,GlobalMedia
    - RULE-SET,ChinaMax,DIRECT
    - RULE-SET,Lan,DIRECT
    - MATCH,Proxy